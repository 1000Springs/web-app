{% extends "layout.html" %}
{% block title %}Home{% endblock %}
{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='galleriffic-2.css')}}" type="text/css" />
<link rel="stylesheet" href="{{ url_for('static', filename='js/snapSVG/style.css')}}" type="text/css" />

  {{ super() }}

<!-- <script type="text/javascript" src="{{ url_for('static', filename='js/jquery.js') }}"></script> -->
<script type="text/javascript" src="{{ url_for('static', filename='js/jQuery/jquery.galleriffic.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/jQuery/jquery.opacityrollover.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/maps.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/Vis/radialTree/d3.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/jQuery/jquery.tipsy.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/views/samplesite.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/snapSVG/snap.svg-min.js') }}"></script>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=true"></script>


<script type="text/javascript">	

	window.onload = function()
	{
		var tempMarkers = [{name:"Frozen Water",value:0},
					   {name:"Human Body", value:37},
					   {name:"Scalding Water", value:55},
					   {name:"Pasteurization", value:67,high:true},
					   {name:"Boiling Water", value:100}];	

		var tempCategories = [];	

			
		var tempBar = ({svg:Snap("#tempBar"),
					length:250,
					x:30,
					y:0,
					max:100,
					current:{{sample_site.phys.initialTemp}},
					markers:tempMarkers,
					categories:tempCategories,
					step:10,
					warning:40,
					units:"°C"});

		addProgressBar(tempBar);

		var phMarkers = [{name:"Stomach Acid",value:1,high:true},
						 {name:"Lemon Juice",value:2},
						 {name:"Vinegar",value:3},
						 {name:"Pure Water",value:6},
						 {name:"Spa Water",value:8},
						 {name:"Soap",value:10},
						 {name:"Ammonia",value:11, high:true},
						 {name:"Bleach",value:12, high:true}];


		var pHCategories = [];			

		var phBar = ({svg:Snap("#pHBar"),
					length:250,
					x:30,
					y:0,
					max:14,
					current:{{sample_site.phys.pH}},
					markers:phMarkers,
					categories:pHCategories,
					step:1,
					units:""});		
		
		addProgressBar(phBar);
	


	};

	$(function()
	{
		
		var sampleSiteMap = setupMap("show_map");	

		{% if sample_site.location.access != "PRIVATE" %}
		addInfoWindowMarker("{{sample_site.location.feature_system}}",
							"{{sample_site.location.lat}}",
							"{{sample_site.location.lng}}",
							"{{sample_site.location.feature_name}}",
							"{{sample_site.location.description}}",
							sampleSiteMap)		
		{% endif %}

		$('img').tooltip();




		$('.accordion').on('show hide', function (n) 
		{
			$(n.target).siblings('.accordion-heading').find('.accordion-toggle i').toggleClass('icon-chevron-up icon-chevron-down');
		});
	});
	</script>





{% endblock %}
{% block content %}


	<div class="title">

		<h2>{{sample_site.location.feature_name}}</h2>

	</div>

<div class="divider"></div>

<div class="row-fluid" style="position:relative;background-color:white;">
	<div class="span7">			
		
		<p>{{sample_site.location.description}}</p> 
			
			
				
			<table class="descTable" >					
				<tr>
					<td>						
						<h5 style="margin-top:0px;" >Location: </h5> 
					</td>
					<td style="text-align:left;">						
							<p>{{sample_site.location.feature_system}}</p>					
					</td>				
				</tr>
				<tr>
					<td>			
						<h5 style="margin-top:0px;" >Sample Date: </h5>
					</td>
					<td style="text-align:left;">
						<p class="muted">{{sample_site.date_gathered.strftime('%d-%m-%Y')}}</p>
					</td>
				</tr>
				<tr>
					<td>			
						<h5 style="margin-top:0px;" >Temperature: </h5> 
					</td>
					<td style="text-align:left;" >					
							<svg width="400px" height="110px" id="tempBar"></svg>
						
					</td>					
				</tr>
				<tr>
					<td>			
						<h5 style="margin-top:0px;" >pH: </h5> 
					</td>
					<td style="text-align:left;" >					
							<svg width="400px" height="110px" id="pHBar"></svg>
						
					</td>					
				</tr>
				<tr>
					<td>			
						<h5 style="margin-top:0px;" >Redox: </h5> 
					</td>

					<td style="text-align:left;">						
						<p> {{sample_site.phys.redox}}mV </p>
					</td>
				</tr>
				<tr>
					<!-- <th colspan=2><strong> Would you like all this data? </strong> </th> -->
				</tr>
				<tr>
					<td> 
						<!-- <a href="{{url_for('download', site_id= sample_site.location_id)}}"> Download data</a> -->
					</td>
				</tr>

		
			</table>
					
	</div>
		
		

<div class="span5">
	
		<div id="show_map"></div>
	

	<div class="divider"></div>
	<div style="margin-bottom:10px;">
		
		<div id="gallery" class="content">

			<div class="slideshow-container">

				<div id="slideshow" class="slideshow"></div>

			</div>

		</div>
		<div class="row-fluid">
			<div class="span1">
				<div id="backward"><img src="{{url_for('static', filename='img/icons/previous.png')}}" style="margin-top:25px;cursor:pointer;"></div>
			</div>

			<div class="span10">
				<div id="thumbs" class="navigation">

					<ul class="thumbs noscript">
						{% for image in sample_site.image %}
							{% if image.image_type == "BESTPHOTO" %}
								
								<li>
									<a class="thumb" name="leaf" href="{{image.image_path}}">
										<img src="{{image.image_path}}"/>
									</a>
								</li>
								
							{% endif %}					
						{% endfor %}					
					</ul>

				</div>
			</div>
			<div class="span1">
				<div id="forward"><img src="{{url_for('static', filename='img/icons/next.png')}}" style="margin-top:25px;cursor:pointer;"></div>
			</div>
		</div>
		
	</div>
</div>
		


	<div class="span12" style="margin:0">
		<div class="accordion" style="position:relative;background-color:white">
		    <div class="accordion-group">
		        <div class="accordion-heading"> 
		            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion1" href="#collapseOne">
		                <i class="icon-chevron-down"></i>
		                Chemical Bubble Chart
		            </a>
		        </div>
			    <div id="collapseOne" class="accordion-body collapse">
				    <div class="accordion-inner" id="bubbles">
				    	
				       {% include "Vis/bubblechart/zoomable.html" %}
				       
				       
				      
				    </div>
			    </div>
		    </div>

		    <div class="accordion-group">
		        <div class="accordion-heading"> 
		            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
		                <i class="icon-chevron-down"></i>
		                Microbial Diversity
		            </a>
		        </div>    
			    <div id="collapseTwo" class="accordion-body collapse">
				    <div class="accordion-inner" id="radialTree">
				    	<h1> Phylogenetic tree </h1>
						<p> hover over tree to read more </p>
				       {% include "Vis/radialTree/index.html" %}
				    </div>
			    </div>
		    </div>
		</div>
	</div>
</div>

	<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				  <!--<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
					<h3 id="myModalLabel">Modal header</h3>
				  </div>!-->
				  <div class="modal-body">
					<div class="container">
							<div class="logincontent" >
							
									<div class="login-form">
										<h2>Login</h2>
										<form action="{{url_for('login')}}" method="post">
											<fieldset>							
													<input type="text" placeholder="Username" name="username" style="display:block" id="usernameTextbox">					
												
													<input type="password" placeholder="Password" name="password" style="display:block">
													<input type="hidden" name="site_id" value="{{sample_site.location_id}}">	

													<button class="btn btn-primary" type="submit">Login</button>
											</fieldset>

										</form>

											{% if error%}						
											<div class="alert" id="alert">
												<button type="button" class="close" data-dismiss="alert">&times;</button>
												<p id="alertMessage"> {{error}} </p>
											</div>
											{% endif %}

									</div>
								
							</div>
						</div>
				  </div>
				<!--  <div class="modal-footer">
				  	
					<button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
				  </div> !-->
				</div>



<script type="text/javascript">
		
 jQuery(document).ready(function($) {

 				$("#forward img").click(function () {
				    gallery.next();
				});

				$("#backward img").click(function () {
				    gallery.previous();
				});
				// We only want these styles applied when javascript is enabled
				$('div.navigation').css({'width' : '300px', 'float' : 'left'});
				$('div.content').css('display', 'block');

				// Initially set opacity on thumbs and add
				// additional styling for hover effect on thumbs
				var onMouseOutOpacity = 0.67;
				$('#thumbs ul.thumbs li').opacityrollover({
					mouseOutOpacity:   onMouseOutOpacity,
					mouseOverOpacity:  1.0,
					fadeSpeed:         'fast',
					exemptionSelector: '.selected'
				});
				
				// Initialize Advanced Galleriffic Gallery
				var gallery = $('#thumbs').galleriffic({
					delay:                     2500,
					numThumbs:                 15,
					preloadAhead:              10,
					enableTopPager:            true,
					enableBottomPager:         true,
					maxPagesToShow:            7,
					imageContainerSel:         '#slideshow',
					 controlsContainerSel:      '#controls',					
					captionContainerSel:       '#caption',
					loadingContainerSel:       '#loading',
					renderSSControls:          true,
					renderNavControls:         true,
					playLinkText:              'Play Slideshow',
					pauseLinkText:             'Pause Slideshow',
					prevLinkText:              '&lsaquo; Previous Photo',
					nextLinkText:              'Next Photo &rsaquo;',
					nextPageLinkText:          'Next &rsaquo;',
					prevPageLinkText:          '&lsaquo; Prev',
					enableHistory:             false,
					autoStart:                 false,
					syncTransitions:           true,
					defaultTransitionDuration: 900,
					onSlideChange:             function(prevIndex, nextIndex) {
						// 'this' refers to the gallery, which is an extension of $('#thumbs')
						this.find('ul.thumbs').children()
							.eq(prevIndex).fadeTo('fast', onMouseOutOpacity).end()
							.eq(nextIndex).fadeTo('fast', 1.0);
					},
					onPageTransitionOut:       function(callback) {
						this.fadeTo('fast', 0.0, callback);
					},
					onPageTransitionIn:        function() {
						this.fadeTo('fast', 1.0);
					}
				});
			});



</script>
{% endblock %}